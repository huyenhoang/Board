<!DOCTYPE html>
<html lang="en">
<head>
    <title>HTML5 Canvas - Chess board</title>
    <meta charset="utf-8" />
    <style>
        button{border-radius:4px; margin:3px; margin-bottom:10px; background-color:#CFCEC2; font-size:medium}
    </style>

    <script src='constant.js'></script>
    <script src='chess_board.js'></script>
        <script src='defaultPosition.js'></script>
</head>
    
	<body onload="draw()">
    	<div width="800" height="800">
        	<button onClick="OnNewGame()">New</button> 
        	<button onClick="OnStartGame()">Start</button> 
            <span style="margin-left:190px; font-size:xx-large; color:#808000"><Strong>Chess Game</Strong></span>
            <button style="margin-left:180px" onClick="OnRedo()">Redo</button>
            <button onClick="OnUndo()">Undo</button>
        </div>
		<div>
			<canvas id="chessboard" width="800" height="800"></canvas>
		</div>
	</body>
    <script>
		var bButtonLock = false;
		var bRedo = false;
		
		function OnNewGame()
		{
			clearChessInfo();
			curGamestate = GS_NONE;
			draw();
		}
		function OnStartGame()
		{
			if(curGamestate != GS_START)
			{
				alert("Start Game!");
				curGamestate = GS_START;
			}
		}
		function OnRedo()
		{
			if(bButtonLock) return;
			if(nHistoryIndex != -1)
			{
				bButtonLock = true;
				bRedo = REDO;
				setTimeout(ReadHistory, 300);
				setTimeout(ReadHistory, 1000); 
				setTimeout(function(){bButtonLock = false;}, 1500);
				writeAllChessInfo();
			}
		}
		function OnUndo()
		{
			if(bButtonLock) return;
			if((nHistoryIndex+1) != arrHistory.length && arrHistory.length !=0)
			{	
				bButtonLock = true;
				bRedo = UNDO;
				setTimeout(ReadHistory, 300);
				setTimeout(ReadHistory, 1000); 
				setTimeout(function(){bButtonLock = false;}, 1500);
				writeAllChessInfo();
			}
		}
		
	</script>
</html>